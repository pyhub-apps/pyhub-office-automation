# 📚 pyhub-office-automation 사용자 가이드

AI 에이전트를 위한 Office 자동화 CLI 도구 완전 사용 가이드입니다.

## 🎯 개요

`pyhub-office-automation`은 Python 지식이 없는 일반 사용자도 AI 에이전트(주로 Gemini CLI)와의 대화를 통해 Excel 및 HWP 작업을 쉽게 자동화할 수 있도록 설계된 CLI 도구입니다.

### 핵심 특징
- 🤖 **AI 에이전트 최적화**: JSON 구조화 출력과 에러 처리
- 📊 **Excel 자동화**: xlwings 기반 강력한 Excel 제어
- 📄 **HWP 자동화**: pyhwpx 기반 한글 문서 처리 (Windows)
- 🔄 **스마트 연결**: 활성 워크북 자동 선택과 효율적 리소스 관리
- 🌍 **크로스 플랫폼**: Windows (전체 기능), macOS (기본 기능)

## 📦 설치 방법

### 방법 1: Windows EXE 파일 (권장)
**Python 설치 없이 바로 사용 가능!**

1. **다운로드**: [GitHub 릴리즈](https://github.com/pyhub-apps/pyhub-office-automation/releases/latest)에서 `oa-windows-amd64.zip` 다운로드
2. **압축 해제**: ZIP 파일을 원하는 위치에 압축 해제
3. **실행**: `oa.exe` 파일을 PowerShell이나 명령 프롬프트에서 실행

```powershell
# 설치 확인
oa.exe --version
oa.exe info
```

### 방법 2: PyPI 패키지 설치
**Python 환경이 있는 경우**

```bash
# PyPI에서 설치
pip install pyhub-office-automation

# 설치 확인
oa --version
oa info
```

### 방법 3: 소스코드에서 설치
**개발자나 고급 사용자용**

```bash
# GitHub에서 클론
git clone https://github.com/pyhub-apps/pyhub-office-automation.git
cd pyhub-office-automation

# 가상환경 생성 및 활성화
python -m venv .venv
.venv\Scripts\activate  # Windows
source .venv/bin/activate  # macOS/Linux

# 개발 모드로 설치
pip install -e .
```

## 🚀 빠른 시작

### 1. 설치 확인
```bash
# 버전 확인
oa --version

# 시스템 정보 확인
oa info

# 설치 가이드 보기
oa install-guide
```

### 2. 첫 번째 Excel 작업
```bash
# Excel 명령어 목록 확인
oa excel list

# 현재 열린 Excel 파일 확인
oa excel workbook-list

# 활성 워크북에서 데이터 읽기
oa excel range-read --range "A1:C10"
```

### 3. 첫 번째 HWP 작업 (Windows 전용)
```bash
# HWP 명령어 목록 확인
oa hwp list

# HWP 파일 열기
oa hwp open --file-path "문서.hwp"
```

## 📊 Excel 자동화 완전 가이드

### 워크북 및 시트 관리

#### 상황 파악
```bash
# 열린 파일 목록 확인
oa excel workbook-list --detailed

# 활성 파일 상세 정보
oa excel workbook-info --include-sheets --include-properties

# 특정 파일 정보
oa excel workbook-info --workbook-name "Sales.xlsx" --include-sheets
```

#### 워크북 조작
```bash
# 새 워크북 생성
oa excel workbook-create --name "새분석" --save-path "analysis.xlsx"

# 기존 파일 열기
oa excel workbook-open --file-path "data.xlsx"

# 시트 관리
oa excel sheet-add --name "결과"
oa excel sheet-activate --name "데이터"
oa excel sheet-rename --old-name "Sheet1" --new-name "원본데이터"
```

### 데이터 읽기/쓰기

#### 범위 데이터 작업
```bash
# 데이터 읽기
oa excel range-read --range "A1:D20"
oa excel range-read --workbook-name "Sales.xlsx" --sheet "Q1" --range "A1:Z100"

# 데이터 쓰기
oa excel range-write --range "A1" --data '["이름", "나이", "부서"]'
oa excel range-write --range "A1:C1" --data '[["김철수", 30, "개발팀"]]'
```

#### 테이블 데이터 작업
```bash
# 테이블 데이터를 CSV로 읽기
oa excel table-read --range "A1:D100" --output-file "result.csv"

# CSV 파일에서 테이블로 쓰기
oa excel table-write --range "A1" --data-file "input.csv"

# 자동 헤더 감지로 테이블 읽기
oa excel table-read --range "A1" --expand "table" --output-file "auto_table.csv"
```

#### 데이터 형식 변환 자동화 (range-convert)

Excel에서 자주 발생하는 **문자열 형태의 숫자 데이터**를 실제 숫자로 변환하는 강력한 도구입니다. 회계 데이터, 외부 시스템 데이터, 사용자 입력 데이터 등에서 필수적입니다.

```bash
# 기본 문자열→숫자 변환 (모든 옵션 활성화)
oa excel range-convert --range "A1:Z100"

# 회계 데이터 일괄 정리
oa excel range-convert --range "B2:F1000" --remove-comma --remove-currency
# 예: "₩1,234,567" → 1234567

# 백분율 데이터를 소수로 변환
oa excel range-convert --range "G1:G100" --parse-percent
# 예: "15.5%" → 0.155, "100%" → 1.0

# 괄호형 음수 처리 (회계 양식)
oa excel range-convert --range "H1:H200"
# 예: "(1,000)" → -1000, "(₩500)" → -500

# 테이블 전체 자동 변환
oa excel range-convert --range "A1" --expand table --remove-currency --remove-comma

# 범위 확장 모드 활용
oa excel range-convert --range "A1:C1" --expand down  # 아래쪽으로 확장
oa excel range-convert --range "A1:A10" --expand right  # 오른쪽으로 확장
```

**지원하는 변환 유형**:

1. **쉼표 제거** (기본 활성화): `"1,234"` → `1234`, `"12,345.67"` → `12345.67`
2. **통화 기호 제거** (기본 활성화): 한국(`₩`), 미국(`$`), 유럽(`€`), 일본(`¥`), 영국(`£`)
3. **백분율 파싱** (기본 활성화): `"50%"` → `0.5`, `"15.5%"` → `0.155`
4. **괄호형 음수** (자동 감지): `"(100)"` → `-100`, `"(1,234)"` → `-1234`

**실무 사용 시나리오**:

**회계 데이터 정리**:
```bash
# ERP 시스템에서 가져온 매출 데이터 일괄 변환
oa excel range-convert --range "A2:F1000" --expand table --remove-currency --remove-comma --parse-percent
```

**설문조사 데이터 정리**:
```bash
# 백분율 응답 데이터를 소수로 변환 (분석용)
oa excel range-convert --range "G1:K500" --parse-percent --no-save
```

**대량 데이터 처리**:
```bash
# 테이블 전체 범위 자동 확장하여 변환
oa excel range-convert --range "A1" --expand table --remove-comma
```

**고급 옵션**:
- `--expand table/down/right`: 데이터 범위 자동 확장
- `--save/--no-save`: 변환 후 저장 여부 제어
- `--format json/text`: 출력 형식 선택 (AI 에이전트용)
- `--visible`: Excel 화면 표시 여부

⚠️ **주의사항**:
- 단일 셀 + `--expand` 조합에서 xlwings 버그 발생 가능
- 대용량 데이터는 부분별로 나누어 처리 권장
- 변환 작업 전 데이터 백업 권장
```

### 차트 생성 (7개 명령어)

**사용 가능한 차트 명령어**:
```bash
oa excel chart-add              # 정적 차트 생성
oa excel chart-pivot-create     # 동적 피벗차트 생성 (Windows 전용)
oa excel chart-list             # 차트 목록 조회
oa excel chart-configure        # 차트 속성 수정
oa excel chart-position         # 차트 위치 이동
oa excel chart-export           # 차트 이미지로 내보내기
oa excel chart-delete           # 차트 삭제
```

#### 정적 차트 (chart-add) - 크로스 플랫폼 지원
**특징**: 고정 데이터 범위, Windows/macOS 모두 지원, 간단하고 빠른 생성

```bash
# 기본 차트 타입별 예제
oa excel chart-add --data-range "A1:C10" --chart-type "column" --title "매출 현황"
oa excel chart-add --data-range "A1:B5" --chart-type "pie" --title "제품별 점유율" --show-data-labels
oa excel chart-add --data-range "A1:C12" --chart-type "line" --title "월별 추세" --legend-position "bottom"
oa excel chart-add --data-range "A1:B4" --chart-type "scatter" --title "상관관계 분석"

# 자동 배치 기능 (겹침 방지)
oa excel chart-add --data-range "A1:C10" --chart-type "column" --auto-position --spacing 80
oa excel chart-add --data-range "A15:C25" --chart-type "line" --auto-position --preferred-position "bottom"

# 대시보드 차트 세트 생성
oa excel chart-add --data-range "Data!A1:D13" --chart-type "column" --sheet "Dashboard" --position "B2" --width 500 --height 300
oa excel chart-add --data-range "Data!F1:G6" --chart-type "pie" --sheet "Dashboard" --auto-position --show-data-labels
```

#### 동적 피벗차트 (chart-pivot-create) - Windows 전용
**특징**: 피벗테이블 기반, 대용량 데이터 최적화, 동적 필터링

```bash
# 기본 피벗차트 생성
oa excel chart-pivot-create --pivot-name "SalesAnalysis" --chart-type "column" --title "지역별 매출"
oa excel chart-pivot-create --pivot-name "ProductSummary" --chart-type "pie" --sheet "Dashboard" --position "B2"

# 대형 대시보드 차트
oa excel chart-pivot-create --pivot-name "QuarterlySummary" --chart-type "column" --width 600 --height 400 --style 5
```

#### 차트 유형별 데이터 구조 가이드

**원형/도넛 차트**: [레이블, 값] - 2열 필수
```bash
oa excel chart-add --data-range "A1:B4" --chart-type "pie" --title "제품별 판매 비중"
```

**막대/열 차트**: [카테고리, 시리즈1, 시리즈2, ...]
```bash
oa excel chart-add --data-range "A1:D4" --chart-type "column" --title "월별 재무 현황"
```

**선 차트**: [시간축, 값1, 값2, ...]
```bash
oa excel chart-add --data-range "A1:C4" --chart-type "line" --title "일별 웹사이트 성과"
```

**산점도**: [X값, Y값]
```bash
oa excel chart-add --data-range "A1:B4" --chart-type "scatter" --title "광고비 대비 매출 상관관계"
```

**버블 차트**: [X값, Y값, 크기값] - 3열 필수
```bash
oa excel chart-add --data-range "A1:C4" --chart-type "bubble" --title "가격-품질-판매량 분석"
```

💡 **차트 선택 가이드**:
- **chart-add**: 고정 데이터, 간단한 보고서, 일회성 차트, 크로스 플랫폼
- **chart-pivot-create**: 대용량 데이터, 동적 분석, 대시보드, Windows 전용

⚠️ **플랫폼별 제약사항**:
- **Windows**: 모든 기능 지원 (피벗차트, 고급 스타일링)
- **macOS**: chart-add만 지원, 피벗차트 불가능

### 피벗테이블 생성 및 관리

#### 2단계 피벗테이블 생성 프로세스
```bash
# 1단계: 빈 피벗테이블 생성
oa excel pivot-create --source-range "Data!A1:F1000" --expand "table" --dest-sheet "분석" --dest-range "A1"

# 2단계: 필드 설정 (반드시 필요)
oa excel pivot-configure --pivot-name "PivotTable1" \
  --row-fields "지역,제품" \
  --value-fields "매출:Sum,수량:Count" \
  --column-fields "분기" \
  --clear-existing

# 데이터 새로고침
oa excel pivot-refresh --pivot-name "PivotTable1"
```

#### 자동 배치로 여러 피벗테이블 생성
```bash
# 첫 번째 피벗테이블 (수동 위치)
oa excel pivot-create --source-range "A1:F100" --dest-range "H1"

# 두 번째 피벗테이블 (자동 배치)
oa excel pivot-create --source-range "A1:F100" --auto-position

# 세 번째 피벗테이블 (방향과 간격 지정)
oa excel pivot-create --source-range "A1:F100" --auto-position --spacing 3 --preferred-position "bottom"
```

### Excel Table (ListObject) 관리 (Windows 전용)

#### Excel Table 생성 및 관리
```bash
# 범위를 Excel Table로 변환
oa excel table-create --range "A1:D100" --table-name "SalesData" --table-style "TableStyleMedium5"

# Excel Table 목록 조회
oa excel table-list --detailed

# 데이터와 함께 Table 생성
oa excel table-write --data-file "sales.csv" --table-name "AutoTable" --table-style "TableStyleLight9"
```

#### 동적 범위 활용
```bash
# Excel Table 기반 피벗테이블 (범위 자동 확장)
oa excel pivot-create --source-range "SalesData" --auto-position --pivot-name "DynamicPivot"

# 새 데이터 추가 시 피벗테이블 범위가 자동으로 확장됨!
```

## 📄 HWP 자동화 가이드 (Windows 전용)

### 기본 문서 조작
```bash
# HWP 명령어 목록
oa hwp list

# 문서 열기
oa hwp open --file-path "보고서.hwp"

# 새 문서 생성
oa hwp create --save-path "새문서.hwp"

# 문서 저장
oa hwp save --file-path "수정된문서.hwp"
```

### 텍스트 처리
```bash
# 텍스트 삽입
oa hwp insert-text --text "안녕하세요" --position "cursor"

# 텍스트 교체
oa hwp replace-text --find "기존텍스트" --replace "새텍스트"

# 텍스트 추출
oa hwp get-text --output-file "extracted.txt"
```

### 고급 기능
```bash
# 표 삽입
oa hwp insert-table --rows 5 --cols 3

# 이미지 삽입
oa hwp insert-image --image-path "chart.png" --width 400 --height 300

# PDF 변환
oa hwp convert-pdf --output-path "document.pdf"
```

## 🔄 AI 워크플로우 패턴

### 1. 스마트 상황 파악 후 작업
```bash
# AI 에이전트가 현재 상황을 파악하는 패턴
oa excel workbook-list --detailed
# → AI가 JSON을 파싱하여 적절한 연결 방법 선택

# 연속 작업 (리소스 효율적)
oa excel workbook-info --workbook-name "sales.xlsx" --include-sheets
oa excel range-read --workbook-name "sales.xlsx" --range "Sheet1!A1:Z100"
oa excel chart-add --workbook-name "sales.xlsx" --data-range "A1:C10"
```

### 2. 완전한 데이터 분석 워크플로우
```bash
# 1단계: 데이터 탐색
oa excel range-read --range "A1:A1" --expand "right"  # 헤더 확인
oa excel workbook-info --include-sheets  # 시트 구조 파악

# 2단계: 데이터 정리
oa excel sheet-add --name "정리된데이터"
oa excel table-read --range "원본!A1" --expand "table" --output-file "temp.csv"
oa excel table-write --sheet "정리된데이터" --range "A1" --data-file "temp.csv"

# 3단계: 분석 (피벗테이블)
oa excel pivot-create --source-range "정리된데이터!A1" --expand "table" --dest-sheet "분석" --dest-range "A1"
oa excel pivot-configure --pivot-name "PivotTable1" --row-fields "카테고리" --value-fields "매출:Sum"

# 4단계: 시각화
oa excel chart-pivot-create --pivot-name "PivotTable1" --chart-type "column" --title "카테고리별 매출"
```

### 3. 자동 배치를 활용한 대시보드 생성
```bash
# 여러 분석 요소를 자동으로 배치
oa excel pivot-create --source-range "A1:F100" --dest-range "H1"  # 첫 번째 (수동)
oa excel pivot-create --source-range "A1:F100" --auto-position    # 두 번째 (자동)
oa excel chart-add --data-range "A1:C10" --auto-position         # 차트 자동 배치
oa excel chart-add --data-range "A15:C25" --auto-position --preferred-position "bottom"
```

## 🎯 사용 시나리오별 가이드

### 월간 보고서 자동화
```bash
# 1. 데이터 수집
oa excel workbook-open --file-path "월간데이터.xlsx"
oa excel table-read --range "A1" --expand "table" --output-file "monthly_data.csv"

# 2. 분석 시트 생성
oa excel sheet-add --name "월간분석"
oa excel table-write --sheet "월간분석" --range "A1" --data-file "monthly_data.csv"

# 3. 피벗 분석
oa excel pivot-create --source-range "월간분석!A1" --expand "table" --dest-range "F1"
oa excel pivot-configure --pivot-name "PivotTable1" --row-fields "부서" --value-fields "실적:Sum"

# 4. 차트 생성
oa excel chart-pivot-create --pivot-name "PivotTable1" --chart-type "column" --title "부서별 월간 실적"
```

### 데이터 정리 및 변환
```bash
# CSV → Excel Table 변환
oa excel workbook-create --name "정리된데이터" --save-path "clean_data.xlsx"
oa excel table-write --range "A1" --data-file "raw_data.csv" --table-name "CleanData"

# 여러 시트 통합
oa excel range-read --sheet "Sheet1" --range "A1" --expand "table" --output-file "sheet1.csv"
oa excel range-read --sheet "Sheet2" --range "A1" --expand "table" --output-file "sheet2.csv"
# → AI가 CSV 파일들을 분석하여 통합
```

### 대시보드 제작
```bash
# 1. 대시보드 시트 준비
oa excel sheet-add --name "Dashboard"

# 2. 주요 지표 차트들 자동 배치
oa excel chart-add --data-range "Data!A1:B12" --sheet "Dashboard" --chart-type "line" --position "B2" --title "월별 추세"
oa excel chart-add --data-range "Data!D1:E8" --sheet "Dashboard" --auto-position --chart-type "pie" --title "카테고리 분포"
oa excel chart-add --data-range "Data!G1:H6" --sheet "Dashboard" --auto-position --chart-type "column" --title "지역별 실적"
```

## 🔧 고급 기능 및 팁

### 연결 방법 최적화
```bash
# 🔥 효율적인 연결 방법 (권장)
# 1. 옵션 없음: 활성 워크북 자동 사용
oa excel range-read --range "A1:C10"

# 2. 워크북 이름으로 연결 (Excel이 이미 열려있는 경우)
oa excel range-read --workbook-name "Sales.xlsx" --range "A1:C10"

# 3. 파일 경로로 연결 (새로 열어야 하는 경우)
oa excel range-read --file-path "/path/to/data.xlsx" --range "A1:C10"
```

### 데이터 범위 확장 활용
```bash
# 동적 범위 확장
oa excel range-read --range "A1" --expand "table"     # 연결된 테이블 전체
oa excel range-read --range "A1" --expand "down"      # 아래로 확장
oa excel range-read --range "A1" --expand "right"     # 오른쪽으로 확장

# 피벗테이블에도 활용
oa excel pivot-create --source-range "A1" --expand "table" --dest-range "F1"
```

### 겹침 방지 자동 배치
```bash
# 자동 배치 옵션들
oa excel chart-add --data-range "A1:C10" --auto-position
oa excel chart-add --data-range "A1:C10" --auto-position --spacing 100 --preferred-position "bottom"

# 겹침 검사
oa excel chart-add --data-range "A1:C10" --position "H5" --check-overlap
```

### macOS 한글 경로 처리
```bash
# macOS에서 한글 파일명 자동 처리 (NFD → NFC 변환)
oa excel range-read --file-path "한글데이터.xlsx" --range "A1:C10"
oa excel workbook-create --save-path "새워크북.xlsx" --name "테스트"
# → 자소분리 문제 자동 해결
```

## 🚨 문제 해결 가이드

### 자주 발생하는 문제들

#### 1. "Excel이 설치되지 않음" 오류
```bash
# Windows: Microsoft Office 또는 Microsoft 365 설치 필요
# macOS: Microsoft Excel for Mac 설치 필요

# 설치 확인
oa info  # "Excel: Available" 확인
```

#### 2. "워크북을 찾을 수 없음" 오류
```bash
# 현재 열린 파일 확인
oa excel workbook-list

# 파일 경로 확인 (절대 경로 사용 권장)
oa excel workbook-open --file-path "C:\Users\Username\Documents\data.xlsx"
```

#### 3. HWP "COM 오류" (Windows)
```bash
# 한글 프로그램이 설치되어 있는지 확인
# 관리자 권한으로 한글 프로그램 한 번 실행
# Windows 보안 설정에서 매크로 허용 확인
```

#### 4. 권한 관련 오류
```bash
# Windows: 관리자 권한으로 PowerShell 실행
# 파일 읽기 전용 속성 해제
# 백신 프로그램 실시간 감시 일시 해제
```

### 디버깅 명령어
```bash
# 시스템 정보 확인
oa info

# 설치 가이드 확인
oa install-guide

# 상세 오류 정보 (JSON 출력)
oa excel range-read --range "A1:C10" --format json
```

## 📚 추가 리소스

### 공식 문서
- **프로젝트 GitHub**: https://github.com/pyhub-apps/pyhub-office-automation
- **차트 기능 상세 가이드**: [`docs/차트-명령어-가이드.md`](./차트-명령어-가이드.md)
- **EXE 빌드 가이드**: [`docs/EXE-빌드-가이드.md`](./EXE-빌드-가이드.md)
- **xlwings 참조**: [`specs/xlwings.md`](../specs/xlwings.md)

### 커뮤니티 지원
- **Issues**: [GitHub Issues](https://github.com/pyhub-apps/pyhub-office-automation/issues)
- **Discussions**: [GitHub Discussions](https://github.com/pyhub-apps/pyhub-office-automation/discussions)

### 개발자 정보
- **개발자**: Chinseok Lee (me@pyhub.kr)
- **라이선스**: MIT License
- **버전 체계**: HeadVer (major.yearweek.build)

---

## 🎉 성공적인 자동화를 위한 체크리스트

### 시작 전 확인
- [ ] ✅ 올바른 설치 방법 선택 (EXE vs PyPI)
- [ ] 💻 필요한 Office 프로그램 설치됨
- [ ] 📁 파일 경로 및 권한 확인
- [ ] 🔧 기본 명령어 동작 확인

### AI 에이전트와 함께 사용할 때
- [ ] 🤖 JSON 출력 형식 이해
- [ ] 🔄 상황 파악 명령어 우선 실행
- [ ] 📊 구조화된 워크플로우 설계
- [ ] ⚡ 효율적인 연결 방법 활용

### 고급 기능 활용
- [ ] 📈 적절한 차트 타입 선택
- [ ] 🎯 자동 배치 기능 활용
- [ ] 🔄 동적 데이터 범위 확장
- [ ] 💾 정기적인 데이터 백업

**AI 에이전트와 함께 강력한 Office 자동화 경험을 즐기세요!** 🚀