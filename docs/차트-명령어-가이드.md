# Excel 차트 명령어 완전 가이드

Excel 자동화를 위한 모든 차트 명령어와 사용법을 체계적으로 정리한 종합 가이드입니다.

## 📊 차트 명령어 개요

### 사용 가능한 차트 명령어 (7개)
```bash
oa excel chart-add              # 정적 차트 생성
oa excel chart-pivot-create     # 동적 피벗차트 생성 (Windows 전용)
oa excel chart-list             # 차트 목록 조회
oa excel chart-configure        # 차트 속성 수정
oa excel chart-position         # 차트 위치 이동
oa excel chart-export           # 차트 이미지로 내보내기
oa excel chart-delete           # 차트 삭제
```

## 🔍 chart-add vs chart-pivot-create 상세 비교

### chart-add (정적 차트)

**특징**:
- 고정된 데이터 범위에서 차트 생성
- 데이터가 변경되어도 차트는 원래 범위만 표시
- Windows와 macOS 모두 지원
- 간단하고 빠른 차트 생성

**적합한 용도**:
- 일회성 보고서 차트
- 고정된 데이터 시각화
- 간단한 프레젠테이션 자료
- 크로스 플랫폼 호환성이 필요한 경우

**사용 예제**:
```bash
# 기본 열 차트
oa excel chart-add --data-range "A1:C10" --chart-type "column" --title "매출 현황"

# 원형 차트 (비율 표시용)
oa excel chart-add --data-range "A1:B5" --chart-type "pie" --title "제품별 판매 비중" --show-data-labels

# 선 차트 (추세 분석용)
oa excel chart-add --data-range "A1:C12" --chart-type "line" --title "월별 매출 추세" --legend-position "bottom"

# 자동 배치로 차트 생성
oa excel chart-add --data-range "A1:C10" --chart-type "column" --auto-position --spacing 80
```

### chart-pivot-create (피벗차트)

**특징**:
- 피벗테이블 기반 동적 차트
- 피벗테이블 필터/필드 변경 시 차트 자동 업데이트
- Windows 전용 (COM API 의존)
- 대용량 데이터 처리에 최적화

**적합한 용도**:
- 대화형 대시보드
- 대용량 데이터 분석
- 동적 필터링이 필요한 경우
- 정기적으로 업데이트되는 보고서

**사용 예제**:
```bash
# 기본 피벗차트 생성
oa excel chart-pivot-create --pivot-name "SalesAnalysis" --chart-type "column" --title "지역별 매출 분석"

# 다른 시트에 피벗차트 생성
oa excel chart-pivot-create --pivot-name "ProductSummary" --chart-type "pie" --sheet "Dashboard" --position "B2"

# 대형 피벗차트 생성
oa excel chart-pivot-create --pivot-name "QuarterlySummary" --chart-type "column" --width 600 --height 400 --style 5
```

## 📈 차트 유형별 데이터 구조 가이드

### 1. 원형/도넛 차트 (pie, doughnut)
**필요 데이터 구조**: [레이블, 값] - 2열 필수

```
| 제품명    | 판매량 |
|-----------|-------|
| 제품A     | 150   |
| 제품B     | 200   |
| 제품C     | 120   |
```

```bash
oa excel chart-add --data-range "A1:B4" --chart-type "pie" --title "제품별 판매 비중"
```

### 2. 막대/열 차트 (column, bar)
**필요 데이터 구조**: [카테고리, 시리즈1, 시리즈2, ...]

```
| 월      | 매출    | 비용    | 순이익  |
|---------|---------|---------|---------|
| 1월     | 1000    | 800     | 200     |
| 2월     | 1200    | 850     | 350     |
| 3월     | 1100    | 900     | 200     |
```

```bash
oa excel chart-add --data-range "A1:D4" --chart-type "column" --title "월별 재무 현황"
```

### 3. 선 차트 (line)
**필요 데이터 구조**: [시간축, 값1, 값2, ...]

```
| 날짜      | 방문자수 | 전환율  |
|-----------|----------|---------|
| 2024-01-01| 1500     | 2.3     |
| 2024-01-02| 1800     | 2.8     |
| 2024-01-03| 1650     | 2.5     |
```

```bash
oa excel chart-add --data-range "A1:C4" --chart-type "line" --title "일별 웹사이트 성과"
```

### 4. 산점도 차트 (scatter)
**필요 데이터 구조**: [X값, Y값] 또는 [X값, Y값, 크기]

```
| 광고비   | 매출     |
|----------|----------|
| 100      | 1200     |
| 200      | 2100     |
| 300      | 2800     |
```

```bash
oa excel chart-add --data-range "A1:B4" --chart-type "scatter" --title "광고비 대비 매출 상관관계"
```

### 5. 버블 차트 (bubble)
**필요 데이터 구조**: [X값, Y값, 크기값] - 3열 필수

```
| 가격    | 품질점수 | 판매량  |
|---------|----------|---------|
| 10000   | 8.5      | 150     |
| 15000   | 9.2      | 200     |
| 12000   | 7.8      | 120     |
```

```bash
oa excel chart-add --data-range "A1:C4" --chart-type "bubble" --title "가격-품질-판매량 분석"
```

## 🎯 자동 배치 기능 활용법

### 기본 자동 배치
```bash
# 첫 번째 차트 (수동 위치)
oa excel chart-add --data-range "A1:C10" --chart-type "column" --position "E1"

# 두 번째 차트 (자동 배치 - 겹침 방지)
oa excel chart-add --data-range "A15:C25" --chart-type "line" --auto-position

# 세 번째 차트 (자동 배치 + 사용자 설정)
oa excel chart-add --data-range "A30:C40" --chart-type "pie" --auto-position --spacing 100 --preferred-position "bottom"
```

### 겹침 검사 활용
```bash
# 특정 위치에 배치하되 겹침 경고 확인
oa excel chart-add --data-range "A1:C10" --chart-type "column" --position "H5" --check-overlap

# 겹침이 감지되면 경고 메시지와 함께 권장사항 제공
```

### 자동 배치 옵션 상세

| 옵션 | 설명 | 기본값 |
|------|------|--------|
| `--auto-position` | 자동 배치 활성화 | false |
| `--spacing` | 최소 간격 (픽셀) | 50 |
| `--preferred-position` | 배치 방향 (right/bottom) | right |
| `--check-overlap` | 겹침 검사 활성화 | false |

## 🎨 차트 스타일링 옵션

### 제목과 범례 설정
```bash
# 제목과 범례 위치 설정
oa excel chart-add --data-range "A1:C10" --chart-type "column" \
  --title "2024년 분기별 매출" \
  --legend-position "bottom"

# 범례 없는 차트
oa excel chart-add --data-range "A1:B5" --chart-type "pie" \
  --title "시장 점유율" \
  --legend-position "none" \
  --show-data-labels
```

### 차트 크기와 위치
```bash
# 대형 차트 생성
oa excel chart-add --data-range "A1:C10" --chart-type "column" \
  --width 600 --height 400 \
  --position "B2"

# 소형 차트 (썸네일용)
oa excel chart-add --data-range "A1:C5" --chart-type "line" \
  --width 250 --height 150 \
  --position "J1"
```

### Windows 전용 고급 스타일링
```bash
# 차트 스타일과 데이터 레이블 적용 (Windows)
oa excel chart-add --data-range "A1:C10" --chart-type "column" \
  --title "매출 분석" \
  --style 15 \
  --legend-position "top" \
  --show-data-labels
```

## 🏢 실전 예제 모음

### 1. 대시보드 차트 세트 생성
```bash
# 1. 메인 매출 차트
oa excel chart-add --data-range "Data!A1:D13" --chart-type "column" \
  --sheet "Dashboard" --position "B2" \
  --title "월별 매출 현황" --width 500 --height 300

# 2. 제품별 비중 차트 (자동 배치)
oa excel chart-add --data-range "Data!F1:G6" --chart-type "pie" \
  --sheet "Dashboard" --auto-position --preferred-position "right" \
  --title "제품별 판매 비중" --show-data-labels

# 3. 추세 분석 차트 (자동 배치)
oa excel chart-add --data-range "Data!A1:B13" --chart-type "line" \
  --sheet "Dashboard" --auto-position --preferred-position "bottom" \
  --title "매출 추세" --legend-position "none"
```

### 2. 피벗 기반 동적 분석 (Windows)
```bash
# 1. 피벗테이블 생성
oa excel pivot-create --source-range "Data!A1:F1000" --dest-sheet "분석" --dest-range "A1"

# 2. 피벗테이블 설정
oa excel pivot-configure --pivot-name "PivotTable1" \
  --row-fields "지역,제품" \
  --value-fields "매출:Sum" \
  --column-fields "분기"

# 3. 피벗차트 생성
oa excel chart-pivot-create --pivot-name "PivotTable1" \
  --chart-type "column" --title "지역별 분기 매출" \
  --position "I1" --width 500 --height 350
```

### 3. 다중 차트 자동 배치
```bash
# 연속된 차트 생성 (겹침 없이)
for i in {1..5}; do
  oa excel chart-add --data-range "Sheet$i!A1:C10" \
    --chart-type "column" \
    --auto-position \
    --title "분석 $i" \
    --spacing 60
done
```

## 🔧 플랫폼별 제약사항

### Windows (전체 기능 지원)
- ✅ 모든 차트 명령어 지원
- ✅ 피벗차트 생성 및 관리
- ✅ 고급 스타일링 (--style, --show-data-labels)
- ✅ 완전한 자동 배치 기능

### macOS (제한적 지원)
- ✅ chart-add 기본 기능
- ✅ 기본 차트 타입 (column, bar, line, pie)
- ❌ chart-pivot-create (Windows 전용)
- ❌ 고급 스타일링 옵션 제한
- ⚠️ 자동 배치 기능 제한적

### 권장 크로스 플랫폼 사용법
```bash
# 모든 플랫폼에서 안전한 기본 차트
oa excel chart-add --data-range "A1:C10" --chart-type "column" \
  --title "매출 현황" \
  --position "E1" \
  --width 400 --height 300

# Windows에서 추가 기능 활용
if [ "$OS" = "Windows" ]; then
  oa excel chart-add --show-data-labels --style 10
fi
```

## 🚨 자주 발생하는 오류와 해결방법

### 1. 데이터 범위 오류
```bash
# ❌ 잘못된 범위 지정
oa excel chart-add --data-range "A1:C"

# ✅ 올바른 범위 지정
oa excel chart-add --data-range "A1:C10"
```

### 2. 피벗테이블 없음 오류 (chart-pivot-create)
```bash
# ❌ 존재하지 않는 피벗테이블
oa excel chart-pivot-create --pivot-name "NonExistentPivot"

# ✅ 피벗테이블 먼저 확인
oa excel pivot-list
oa excel chart-pivot-create --pivot-name "PivotTable1"
```

### 3. 차트 타입 불일치
```bash
# ❌ 원형 차트에 부적합한 데이터 (3열 이상)
oa excel chart-add --data-range "A1:D10" --chart-type "pie"

# ✅ 원형 차트용 2열 데이터 사용
oa excel chart-add --data-range "A1:B10" --chart-type "pie"
```

## 💡 고급 활용 팁

### 1. 차트 템플릿 스크립트
```bash
#!/bin/bash
# 표준 대시보드 차트 생성 스크립트

create_dashboard_charts() {
  local data_sheet="$1"
  local dashboard_sheet="$2"

  # 메인 트렌드 차트
  oa excel chart-add --data-range "${data_sheet}!A1:B13" \
    --chart-type "line" --sheet "$dashboard_sheet" \
    --position "B2" --title "주요 지표 추세" \
    --width 500 --height 250

  # 카테고리 분석 차트 (자동 배치)
  oa excel chart-add --data-range "${data_sheet}!D1:E8" \
    --chart-type "column" --sheet "$dashboard_sheet" \
    --auto-position --title "카테고리별 분석" \
    --width 400 --height 300

  # 비율 차트 (자동 배치)
  oa excel chart-add --data-range "${data_sheet}!G1:H6" \
    --chart-type "pie" --sheet "$dashboard_sheet" \
    --auto-position --preferred-position "bottom" \
    --title "구성 비율" --show-data-labels
}

# 사용 예
create_dashboard_charts "Data" "Dashboard"
```

### 2. 동적 데이터 범위 활용
```bash
# 데이터 범위 자동 확장 활용
oa excel chart-add --data-range "A1" --expand "table" \
  --chart-type "column" --title "전체 데이터 차트"

# 특정 방향으로만 확장
oa excel chart-add --data-range "A1:A1" --expand "down" \
  --chart-type "line" --title "시계열 데이터"
```

### 3. 조건부 차트 생성
```bash
#!/bin/bash
# 데이터 크기에 따른 조건부 차트 타입 선택

data_range="A1:C10"
row_count=$(oa excel range-read --range "$data_range" --format json | jq '.data | length')

if [ "$row_count" -lt 6 ]; then
  chart_type="pie"
  title="소량 데이터 분석"
else
  chart_type="column"
  title="상세 데이터 분석"
fi

oa excel chart-add --data-range "$data_range" \
  --chart-type "$chart_type" --title "$title"
```

이 가이드를 통해 Excel 차트 자동화의 모든 기능을 효과적으로 활용할 수 있습니다. 각 명령어의 특성을 이해하고 상황에 맞는 최적의 선택을 하시기 바랍니다.