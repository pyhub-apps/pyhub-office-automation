## Gemini CLI 특화 기능

### 대화형 컨텍스트 활용

Gemini CLI의 연속 대화 특성을 활용하여 Excel 작업의 컨텍스트를 유지:

#### 세션 시작 시 컨텍스트 설정
```bash
# 작업 시작 시 실행할 명령들
oa excel workbook-list  # 현재 상황 파악
oa excel workbook-info --include-sheets  # 활성 워크북 구조 확인
```

#### 연속 작업에서 상태 유지
```markdown
**현재 작업 컨텍스트를 기억해주세요:**
- 활성 워크북: [워크북명]
- 작업 중인 시트: [시트명]
- 마지막 작업 범위: [범위]
- 진행 중인 분석: [분석 내용]
```

### 단계별 대화형 워크플로우

#### 1. 데이터 탐색 단계
```
사용자: "Excel 파일의 데이터를 분석해주세요"

AI 응답 패턴:
1. oa excel workbook-list로 현재 상황 확인
2. oa excel workbook-info로 구조 파악
3. oa excel range-read로 샘플 데이터 확인
4. 사용자에게 분석 방향 제안
```

#### 2. 대화형 차트 생성
```
사용자: "판매 데이터로 차트를 만들어주세요"

AI 대화 흐름:
1. "어떤 종류의 차트를 원하시나요? (막대형/선형/원형)"
2. "비교하고 싶은 항목은 무엇인가요?"
3. "시간 기간은 어떻게 설정할까요?"
4. 차트 생성 후 "추가로 수정하고 싶은 부분이 있나요?"
```

### Gemini의 멀티턴 대화 최적화

#### 컨텍스트 유지 전략
```python
# 세션 상태 추적 (Gemini CLI에서 내부적으로 관리)
session_context = {
    "current_workbook": None,
    "active_sheet": None,
    "last_range": None,
    "working_data": None,
    "chart_count": 0,
    "analysis_progress": []
}
```

#### 점진적 작업 진행
1. **상황 파악**: "현재 어떤 파일로 작업하고 있나요?"
2. **요구사항 확인**: "어떤 분석이나 차트가 필요한가요?"
3. **단계별 실행**: "먼저 데이터를 확인해보겠습니다..."
4. **결과 검토**: "결과가 어떤가요? 추가로 필요한 작업이 있나요?"

### 자연어 명령 해석

#### 사용자 요청 → oa 명령 변환 예시

```
사용자: "A열과 B열 데이터로 막대 차트 만들어줘"
↓
해석: 범위 A:B의 데이터로 Column 차트 생성
↓
실행: oa excel chart-add --data-range "A:B" --chart-type "Column"
```

```
사용자: "이번 달 매출이 가장 높은 지역 5곳 보여줘"
↓
해석: 데이터 필터링 + 정렬 + 상위 5개 추출
↓
실행: 1. oa excel range-read (전체 데이터)
      2. Python pandas로 필터링/정렬
      3. oa excel range-write (결과 출력)
```

### 오류 상황 대화형 처리

```
오류 발생 시 Gemini 대응 패턴:

1. 문제 상황 설명
   "Excel 파일을 찾을 수 없습니다. 다음을 확인해주세요:"

2. 해결 방법 제시
   - oa excel workbook-list로 열린 파일 확인
   - 파일 경로 재확인
   - Excel 프로그램 실행 상태 점검

3. 대안 제안
   "파일이 없다면 새로 만들어드릴까요?"
   "다른 파일로 작업해보시겠어요?"
```

### 추천 대화 시나리오

#### 시나리오 1: 데이터 분석 세션
```
1. "안녕하세요! Excel 데이터 분석을 도와드리겠습니다."
2. "먼저 현재 열린 파일을 확인해보겠습니다."
3. [oa excel workbook-list 실행]
4. "○○.xlsx 파일이 열려있네요. 어떤 분석을 원하시나요?"
5. [사용자 요청에 따라 단계별 진행]
```

#### 시나리오 2: 차트 생성 세션
```
1. "차트 생성을 도와드리겠습니다."
2. "데이터 범위를 확인해보겠습니다."
3. [데이터 미리보기 제공]
4. "이 데이터로 어떤 인사이트를 얻고 싶으신가요?"
5. [적절한 차트 유형 제안 및 생성]
```